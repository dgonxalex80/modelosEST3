<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Modelos Estadísticos para la toma de decisiones" />


<title> Modelo Lineal General - Logit binomial</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Modelos Estadísticos para la toma de decisiones</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Conceptos 
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso100.html">Conceptos básicos</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    MDE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso200.html">Modelo de Diseño de Experimentos </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    ML
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso300.html">Modelo Lineal General - Logit binomial  </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    AC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso500.html">Análisis de conglomerados</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    ACP
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="recurso600.html">Análisis de Componentes Principales</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore"><span style="color:#034a94"> <strong>Modelo
Lineal General - Logit binomial</strong></span></h1>
<h4 class="author">Modelos Estadísticos para la toma de decisiones</h4>

</div>


<p></br></br></p>
<div id="introducción" class="section level2">
<h2><span
style="color:#034A94"><strong>Introducción</strong></span></h2>
<p><br/></p>
<p>La regresión logística tiene la misma estructura presentada en el
modelo de regresión lineal múltiple, solo que la variable dependiente es
no numérica y corresponde a una variable cualitativa con dos valores
(bivariada). En este caso el modelo se denomina Logit binomial.</p>
<p><br/></p>
<p>Este modelo esta relacionado con predicción y explicación de las
decisiones de los consumidores, la clasificación de los clientes de un
banco y presenta como función de ajuste la <strong>función
logit</strong> que corresponde a una función en forma de s, en lugar de
una linea recta como lo hace la regresión lineal simple.</p>
<p><br/></p>
<p>El objetivo de la <strong>regresiòn logística</strong> es la de
predecir la probabilidad de que una variable binaria (dicotómica) tome
los valores posibles en la que esta está definida (<span
class="math inline">\(R_Y= \{0,1 \}\)</span>, mediante la combinación
lineal de una o varias variables independientes cuantitativas o
cualitativas. La regresiòn logistica hace parte de los modelos lineales
generalizados en donde se usa una función de enlace llamada logit.</p>
<p></br></p>
<div class="content-box-blue">
<p><span class="math display">\[Y = \beta_{0} + \beta_{1}X_{1} +
\varepsilon\]</span></p>
</div>
<p></br></p>
</div>
<div id="supuestos-y-requisitos" class="section level2">
<h2><span style="color:#034a94"><strong>Supuestos y
requisitos</strong></span></h2>
<p></br></p>
<p>El supuesto principal está relacionado con la ausencia de
multicolinealidad o en caso de existir que sea muy baja, pues de no ser
así se puede afectar el resultado de las estimaciones, además de
aumentar artificialmente los errores de los estimadores de los
coeficientes</p>
<p>Tambien se supone que la variable dependiente es una variable con
distribución Bernoulli o binomial con <span
class="math inline">\(n=1\)</span>. Teniendo el valor de uno cuando se
obtiene éxito y cero cuando la variable representa fracaso.</p>
<p></br></br></p>
<div id="ejemplo" class="section level3">
<h3><span style="color:#FF7F00"><strong>Ejemplo</strong></span></h3>
<p></br></p>
<p>El siguiente problema es tomado del documento realizado por <a
href="https://rpubs.com/Joaquin_ARhttps://web.whatsapp.com//229736">Joaquín
Amat Rodrigo</a> publicado en RPlus con el fin de presentar el modelo
logit simple</p>
<p></br></p>
<p>Se pretende ilustrar los componentes del modelo lineal general para
el caso particular del modelo de logit simple, enmarcado dentro de los
modelos llamados <strong>modelos de probabilidad</strong> y determinar
la probabilidad de que un estudiante obtenga matricula de honor a partir
de la nota obtenida en matemáticas</p>
<p></br></br></p>
</div>
</div>
<div id="preguntas" class="section level2 content-box-gray">
<h2><span style="color:#686868"><strong>Preguntas</strong></span></h2>
<p><br/></p>
<ul>
<li><p>Cómo se estiman los modelos de regresión con variables
cualitativas como variables respuesta?</p></li>
<li><p>Qué problemas se presentan cuando se desean realizar inferencias?
Que pruebas de hipotesis se deben realizar?</p></li>
<li><p>Como se mide la bondad de ajuste del modelo estimado?</p></li>
<li><p>Como se interpretan los resultados obtenidos?</p></li>
</ul>
<p>Preguntas planteadas en Gujarati(2009)</p>
</div>
<p>Con el prósito de responder a esta preguntas, empezaremos con las
caracteristicas de los datos</p>
<p></br></br></p>
<div id="datos" class="section level3">
<h3><span style="color:#686868"><strong>Datos</strong></span></h3>
<p></br></p>
<p>La data: <code>matricular</code> de <code>paqueteMOD</code>, contiene
los datos de un conjunto de estudiantes que han obtenido matricula de
honor (<code>matricula = 1</code>) y un grupo de no la han conseguido
(<code>matricula = 0</code>) y sus respectivas notas obtenidas en
matemáticas</p>
<p></br></p>
<p>En este caso se debe contar con una variable categórica con dos
niveles representados por dos valores : <span
class="math inline">\(0\)</span> y <span
class="math inline">\(1\)</span> (variable matricula), quien obra como
variable dependiente y por lo menos una variable cuantitativa que tome
diferentes valores (en este caso la nota de matemáticas).</p>
<p></br></p>
<pre class="r"><code>library(paqueteMOD)
data(&quot;matricular&quot;)
summary(matricular)</code></pre>
<pre><code> matricula  matematicas   
 0:151     Min.   :33.00  
 1: 49     1st Qu.:45.00  
           Median :52.00  
           Mean   :52.65  
           3rd Qu.:59.00  
           Max.   :75.00  </code></pre>
<p></br></br></p>
<p>Distribución de matriculados:</p>
<p>Utilizamos la función <code>table()</code> para encontrar la
distribución de la variable categórica matricula:</p>
<p></br></p>
<pre class="r"><code>table(matricular$matricula)</code></pre>
<pre><code>
  0   1 
151  49 </code></pre>
<p></br></br></p>
<p>Distribución del puntaje en matemáticas por tipo de matricula</p>
<p></br></p>
<p>Tambien podemos explorar el comportamiento de la variable
cuantitativa (matemáticas) para las dos categorías, que en este caso
corresponde a la distribución de las notas por tipo de matricula :</p>
<pre class="r"><code>library(ggplot2)
ggplot(data = matricular, aes(x = as.factor(matricula), y = matematicas, color = matricula)) +
  geom_boxplot() +
  geom_jitter(width = 0.2)+
  scale_color_manual(values=c(&quot;#FF7F00&quot;,&quot;#034A94&quot;))+
  labs(x = &quot;matricula de honor&quot;, y = &quot;puntaje matemáticas&quot;) +
  ggtitle(&quot;  &quot;)</code></pre>
<p><img src="recurso300_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p></br></br></br></p>
</div>
<div id="modelo-logit" class="section level2">
<h2><span style="color:#034A94"><strong>Modelo logit</strong></br></h2>
<p></br></p>
<p>Inicialmente podríamos explorar una estimación de
<strong>MCO</strong>, como posibilidad de estimación:</p>
<p><span class="math display">\[
Y = \beta_{0} + \beta_{1}X_{1} + \varepsilon
\]</span> Den de la variable <span class="math inline">\(Y\)</span> es
una variable con dos categorías (binaria), la variable <span
class="math inline">\(X\)</span> corresponde a una variable numérica y
<span class="math inline">\(\varepsilon\)</span> corresponde a una
variable aleatoria no observable.</p>
<p>Com prueba inicial y de comparación se plantea realizar la estimación
por el método de mínimos cuadrados ordinarios.</p>
<pre class="r"><code>library(tidyverse)

matricular$matricula=as.numeric(matricular$matricula)

matricular %&gt;% 
   lm(matricula ~ matematicas ,  data = .) -&gt; modelo0
summary(modelo0) </code></pre>
<pre><code>
Call:
lm(formula = matricula ~ matematicas, data = .)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.76516 -0.27653 -0.06712  0.17720  1.02596 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.020053   0.150883   0.133    0.894    
matematicas 0.023268   0.002822   8.245 2.25e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.3729 on 198 degrees of freedom
Multiple R-squared:  0.2556,    Adjusted R-squared:  0.2518 
F-statistic: 67.99 on 1 and 198 DF,  p-value: 2.248e-14</code></pre>
<p>El resultado muestra un valor muy bajo de ajuste, dado que los puntos
están sobre el eje horizontal con <span
class="math inline">\(Y=0\)</span> o en el eje horizontal con <span
class="math inline">\(Y=1\)</span></p>
<pre class="r"><code>library(ggplot2)
# data(matricular)
matricular1=matricular
matricular1$matricula = as.numeric(matricular1$matricula)

g3=ggplot(data = matricular1, mapping = aes(x=matematicas, y=matricula)) + 
           geom_point() + 
           geom_smooth(method = &quot;lm&quot;, se=FALSE) +         
           labs(y = &quot;matricula de honor&quot;, x = &quot;puntaje matemáticas&quot;) +
           ggtitle(&quot;  &quot;)

g3</code></pre>
<p><img src="recurso300_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p></br></br></p>
<p>Como se puede observar este modelo no permite ajustar una linea que
represente los valores obtenidos en la prueba de matemáticas. Además de
no cumplir con los supuestos planteados para el modelo de regresión
lineal simple.</p>
<ul>
<li>No normalidad de los errores</li>
<li>Heteroscedasticidad de errores</li>
<li>Posibilidad de que <span
class="math inline">\(\widehat{Y_{i}}\)</span> se encuentre por fuera
del rango <span class="math inline">\([0,1]\)</span>, siendo que
estimación de <span class="math inline">\(Y\)</span> debe corresponder a
la probabilidad de ocurrencia de <span
class="math inline">\(Y\)</span></li>
<li>Valores muy bajos para <span class="math inline">\(R^{2}\)</span>,
dada la dificultad de ajuste de los datos a una linea recta</li>
</ul>
<p></br></br></p>
<p>Estos problemas los podemos superar al plantear el siguiente modelo
teniendo como base la función de distribución acumulada <span
class="math inline">\(F(x) = P(X \leq x)\)</span> y la función
logística:</p>
<p></br></p>
<div class="content-box-blue">
<p><span class="math display">\[f(z)= \dfrac{1}{1+\exp{\{-z\}}} =
\dfrac{\exp{\{z\}}}{1-\exp{\{z\}}}\]</span></p>
</div>
<p></br></p>
<p>De esta ecuación podemos definir :</p>
<p><span class="math display">\[P_{i} = P(Y=1 | X =x)
=  \dfrac{1}{1+\exp{\{-\beta_{0}-\beta_{1}x_{i}\}}}
+  \varepsilon_{i}^{*}= \dfrac{\exp{\{ \beta_{0}-\beta_{1}x_{i}
\}}}{1-\exp{\{\beta_{0}-\beta_{1}x_{i}\}}} +
\varepsilon_{i}^{*}\]</span></p>
<p>y por tanto su complemento está dado por :</p>
<p><span class="math display">\[1- P_{i} = P(Y=0 | X =x) =  \dfrac{1}{1
+ \exp{\{ \beta_{0}-\beta_{1}x_{i} \}}} \]</span></p>
<p>La división de estas dos probabilidades genera <span
class="math inline">\(odds\)</span></p>
<p><span
class="math display">\[\Bigg(\dfrac{P(Y=k|X=x)}{1-P(Y=k|X=x)}\Bigg)
=  \exp{\Big\{\beta_{0}+ \beta_{1} \hspace{.2cm}x_{i} \Big\}} +
\varepsilon_{i}^{*}\]</span> Y finalmente al sacar logaritmos en ambos
lados se obtiene la siguiente expresión lineal:</p>
<p><span class="math display">\[\ln
\Bigg(\dfrac{P(Y=k|X=x)}{1-P(Y=k|X=x)}\Bigg) =  \beta_{0}+ \beta_{1}
\hspace{.2cm}x_{i} + \varepsilon_{i}^{*}\]</span> </br></p>
<pre class="r"><code>library(ggplot2)
fx=function(x){
  1/(1+exp(-x))
}

ggplot(data.frame(x=c(-8, 8)), aes(x)) + stat_function(fun=fx, size=1, col=&quot;#FF7F00&quot;)</code></pre>
<p><img src="recurso300_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p></br></br></p>
<p>Empleando la función logística se replantea el modelo partiendo del
<strong>logaritmo de la razón de probabilidades</strong> en función de
una combinación lineal de las variables independientes :</p>
<p><span class="math display">\[\ln
\Bigg(\dfrac{P(Y=k|X=x)}{1-P(Y=k|X=x)}\Bigg) =  \beta_{0}+ \beta_{1}
\hspace{.2cm}x_{i} + \varepsilon_{i}^{*}\]</span> </br></br></p>
<p>Su estimación se puede plantear de manera resumida como:</p>
<div class="content-box-blue">
<p><span class="math display">\[\ln \Bigg(\dfrac{P_{i}}{1-P_{i}} \Bigg)
= \ln (odds) =\beta_{0} + \beta_{1} \hspace{.2cm}x_{i} +
\varepsilon_{i}^{*}\]</span></p>
</div>
<p></br></p>
<p>Donde :</p>
<ul>
<li><span class="math inline">\(odds = \dfrac{P_{i}}{1-P_{i}} =
\dfrac{P(Y=k|X=x)}{1-P(Y=k|X=x)}\)</span>, llamada tambien <strong>razón
de probabilida</strong> o <strong>ratio ODDS</strong></li>
</ul>
<p></br></p>
<ul>
<li><span class="math inline">\(\ln(odds) = \ln
\Bigg(\dfrac{P_{i}}{1-P_{i}} \Bigg) = \ln
\Bigg(\dfrac{P(Y=k|X=x)}{1-P(Y=k|X=x)}\Bigg)\)</span></li>
</ul>
<p></br></p>
<ul>
<li><span class="math inline">\(\ln \Bigg(\dfrac{1}{0}\Bigg)
\hspace{.5cm}\text{si el estudiante RECIBE matricula de
honor}\)</span></li>
</ul>
<p></br></p>
<ul>
<li><span class="math inline">\(\ln \Bigg(\dfrac{0}{1}\Bigg)
\hspace{.5cm}\text{si el estudiante NO RECIBE matricula de
honor}\)</span></li>
</ul>
<p></br></br></p>
<p>El resultado se puede interpretar como:</p>
<p></br></p>
<table>
<colgroup>
<col width="4%" />
<col width="18%" />
<col width="10%" />
<col width="39%" />
<col width="11%" />
<col width="16%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">Si</td>
<td align="left"><span class="math inline">\(P_{i} =
1-P_{i}\)</span></td>
<td align="left">entonces</td>
<td align="left"><span class="math inline">\(\dfrac{P_{i}}{1-P_{i}} =
odds =1\)</span>,</td>
<td>por tanto</td>
<td align="left"><span class="math inline">\(\ln(odds) = 0\)</span></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Si</td>
<td align="left"><span class="math inline">\(P_{i} &lt;
1-P_{i}\)</span></td>
<td align="left">entonces</td>
<td align="left"><span class="math inline">\(\dfrac{P_{i}}{1-P_{i}} =
odds &lt; 1\)</span>,</td>
<td>por tanto</td>
<td align="left"><span class="math inline">\(\ln(odds) &lt;
0\)</span></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Si</td>
<td align="left"><span class="math inline">\(P_{i} &gt;
1-P_{i}\)</span></td>
<td align="left">entonces</td>
<td align="left"><span class="math inline">\(\dfrac{P_{i}}{1-P_{i}} =
odds &gt; 1\)</span>,</td>
<td>por tanto</td>
<td align="left"><span class="math inline">\(\ln(odds) &gt;
0\)</span></td>
</tr>
</tbody>
</table>
<p></br></p>
<div id="nota" class="section level3 content-box-yellow">
<h3><span style="color:#686868"><strong>Nota:</strong></span></h3>
<ul>
<li><p><span class="math inline">\(P_{i}\)</span> : probabilidad de
recibir matricula de honor</p></li>
<li><p><span class="math inline">\(1-P_{i}\)</span> : probabilidad de no
recibir matricula de honor</p></li>
</ul>
</div>
<p></br></br></p>
</div>
<div id="estimación-del-modelo" class="section level2">
<h2><span style="color:#034A94"><strong>Estimación del
modelo</strong></span></h2>
<p></br></p>
<p>Para realizar la estimación del modelo logit utilizamos la función
<code>glm()</code></p>
<pre class="r"><code>library(tidyverse)
data(matricular)
matricular %&gt;% 
  glm(matricula ~ matematicas , family = binomial(link = &quot;logit&quot;), data = .) -&gt; modelo1
summary(modelo1) </code></pre>
<pre><code>
Call:
glm(formula = matricula ~ matematicas, family = binomial(link = &quot;logit&quot;), 
    data = .)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0332  -0.6785  -0.3506  -0.1565   2.6143  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -9.79394    1.48174  -6.610 3.85e-11 ***
matematicas  0.15634    0.02561   6.105 1.03e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 222.71  on 199  degrees of freedom
Residual deviance: 167.07  on 198  degrees of freedom
AIC: 171.07

Number of Fisher Scoring iterations: 5</code></pre>
<p></br></br></p>
<p>El modelo estimado en su forma original :</p>
<p><span class="math display">\[\ln \Bigg(
\dfrac{\widehat{P_{i}}}{1-\widehat{P_{i}}} \Bigg) = \widehat{\beta_{0}}
+ \widehat{\beta_{1}} \hspace{.2cm}x_{i}\]</span> </br></br></p>
<p>Utilizamos la función inversa del logaritmo</p>
<p><span class="math display">\[\Bigg(
\dfrac{\widehat{P_{i}}}{1-\widehat{P_{i}}} \Bigg) = \exp{\bigg\{
\widehat{\beta_{0}} + \widehat{\beta_{1}} \hspace{.2cm}
x_{i}}\bigg\}\]</span> </br></br></p>
<p><span class="math display">\[\Bigg(
\dfrac{\widehat{P_{i}}}{1-\widehat{P_{i}}} \Bigg) = \exp{\big\{
-9.793942  + 0.1563404 \hspace{.2cm}x_{i}}\big\}\]</span> </br></br></p>
</div>
<div id="interpretación-de-los-coeficientes" class="section level2">
<h2><span style="color:#034A94"><strong>Interpretación de los
coeficientes</strong></span></h2>
<p></br></br></p>
<div id="beta_0" class="section level3">
<h3><span style="color:#034A94"><span
class="math inline">\(\beta_{0}\)</span></span></h3>
<p></br></p>
<p>El coeficiente estimado <span
class="math inline">\(\widehat{\beta}_{0}\)</span> corresponde al valor
esperado del logaritmo de la razón de probabilidades para un estudiante
con nota cero en matemáticas. Para leerlo en términos de razón de
probabilidades realizamos la siguiente transformación:</p>
<pre><code>exp{b0} = exp{-9.793942} =  5.578854e-05</code></pre>
<p>Cuando <span class="math inline">\(x=0\)</span> el valor de la razón
de probabilidades es de <span
class="math inline">\(0.0000557885\)</span>, indicando que la
probabilidad <span class="math inline">\((1-P_{i})\)</span> es mucho mas
grande que <span class="math inline">\(P_{i}\)</span> . Lo cual es
consecuente, dado que obtener un puntaje en el examen de matemáticas
<span class="math inline">\(x=0\)</span>, estima una probabilidad de
obtener matricula de honor de</p>
<p></br></br></p>
</div>
<div id="beta_1" class="section level3">
<h3><span style="color:#034A94"><span
class="math inline">\(\beta_{1}\)</span></span></h3>
<p></br></p>
<p>Ahora para interpretar el aporte que genera un punto adicional en la
nota de matemáticas sobre la probabilidad realizamos el siguiente
cálculo:</p>
<p><span class="math display">\[\exp{\{ 0.1563404 \}} =
1.169224\]</span></p>
<pre><code>exp(0.1563404) =  1.169224</code></pre>
<p></br></br></p>
<p><span class="math inline">\(\widehat{\beta}_{1}\)</span> indica el
cambio en <span class="math inline">\(ln(p/(1-p))\)</span> debido a un
incremento unitario en <span class="math inline">\(x\)</span>, por lo
que es necesario sacar la función inversa al logaritmo que es la función
exponencial (<code>exp()</code>)</p>
<p>Por cada unidad de aumento de <span class="math inline">\(x\)</span>
los <span class="math inline">\(odds\)</span> de obtener matricula se
incrementan en : <span class="math inline">\(1.17\)</span> unidades</p>
<pre class="r"><code>exp(b1)</code></pre>
<pre><code>         
1.169224 </code></pre>
<p>Un intervalo de confianza para los coeficientes se puede obtener
mediante :</p>
<pre class="r"><code>library(MASS)
confint(object = modelo1, level = 0.95 )</code></pre>
<pre><code>                  2.5 %     97.5 %
(Intercept) -12.9375208 -7.0938806
matematicas   0.1093783  0.2103937</code></pre>
<p></br></p>
<pre class="r"><code>data(matricular)
matricular$matricula &lt;- as.character(matricular$matricula)
matricular$matematicas &lt;- as.numeric(matricular$matematicas)

plot(matricula ~ matematicas, matricular, col = &quot;darkblue&quot;,
     main = &quot;Modelo regresión logística&quot;,
     ylab = &quot;P(matrícula=1|matemáticas)&quot;,
     xlab = &quot;matemáticas&quot;, pch = &quot;I&quot;)

# type = &quot;response&quot; devuelve las predicciones en forma de probabilidad en lugar de en log_ODDs
curve(predict(modelo1, data.frame(matematicas = x), type = &quot;response&quot;),
      col = &quot;#034A94&quot;, lwd = 3, add = TRUE)
abline(h=.50, col=&quot;red&quot;)


grid()</code></pre>
<p><img src="recurso300_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p></br></br></br></p>
</div>
</div>
<div id="bondad-de-ajuste-del-modelo" class="section level2">
<h2><span style="color:#034A94"><strong>Bondad de ajuste del
modelo</strong></span></h2>
<p></br></p>
<p>Para determinar la bondad de ajuste del modelo se utiliza el
resultado de la probabilidad que estima el modelo y se asigna un valor
de cero para los individuos que tengan valores menores o iguales a un
punto <span class="math inline">\(c\)</span>, que en este caso tomamos
como <span class="math inline">\(0.50\)</span>. Para valores mayores a
<span class="math inline">\(0.5\)</span> se asigna un valor de <span
class="math inline">\(1\)</span></p>
<p></br></p>
<pre class="r"><code>library(vcd)
predicciones &lt;- ifelse(test = modelo1$fitted.values &gt; 0.5, yes = 1, no = 0)
mc &lt;- table(modelo1$model$matricula, predicciones,
                          dnn = c(&quot;observaciones&quot;, &quot;predicciones&quot;))
mc</code></pre>
<pre><code>             predicciones
observaciones   0   1
            0 140  11
            1  27  22</code></pre>
<p></br></p>
<pre class="r"><code>mosaic(mc, shade = T, colorize = T,
       gp = gpar(fill = matrix(c(&quot;#11224D&quot;, &quot;#F98125&quot;, &quot;#F5B841&quot;,&quot;#2C599D&quot;), 2, 2)))</code></pre>
<p><img src="recurso300_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p></br></p>
<p>Los colores azules representan la proporción de clasificaciones
correcta :</p>
<ul>
<li>Siendo 0, lo clasifica como 0 y</li>
<li>Siendo 1 lo clasifica como 1</li>
</ul>
<p>Los colores naranjas corresponden a las proporciones de
clasificaciones erradas por el modelo.</p>
<p>La proporción de clasificaciones correctas dan una aproximación del
valor <span class="math inline">\(R^2\)</span></p>
<p></br></p>
<p><span class="math display">\[
\dfrac{140+22}{140+27+11+22} = \dfrac{162}{200} = 0.81
\]</span> Este valor cuenta como el <span
class="math inline">\(R^2\)</span> , es decir que el modelo explica
(clasifica de manera adecuada) el 81% de los casos</p>
<p></br></br></p>
<!-- Cuenta $R^{2}$ -->
<!-- ```{r} -->
<!-- cuenta_R2= sum(diag(mc))/sum(mc) -->
<!-- cuenta_R2 -->
<!-- ``` -->
<pre class="r"><code>library(DescTools)
PseudoR2(modelo1, which = &quot;McFadden&quot;)</code></pre>
<pre><code> McFadden 
0.2498172 </code></pre>
<p></br></p>
<pre class="r"><code>library(pscl)
pR2(modelo1)</code></pre>
<pre><code>fitting null model for pseudo-r2</code></pre>
<pre><code>         llh      llhNull           G2     McFadden         r2ML         r2CU 
 -83.5366186 -111.3550233   55.6368095    0.2498172    0.2428425    0.3615832 </code></pre>
<div id="nota-1" class="section level3 content-box-yellow">
<h3><span style="color:#686868"><strong>Nota:</strong></span></h3>
<p>Es importante resaltar que en este tipo de modelos la bondad de
ajuste pasa a un segundo plano y cobra importancia el signo de los
coeficientes y su significancia estadística.</p>
</div>
<p></br></br></br></p>
</div>
<div id="predicción" class="section level2">
<h2><span style="color:#034A94"><strong>Predicción</strong></span></h2>
<p></br></p>
<p>Predecir la probabilidad de que un estudiante pueda tener matricula
de honor con un puntajes en matemáticas de: 30,40,50,60, 70 puntos</p>
<p></br></p>
<pre class="r"><code>newdata1 &lt;- data.frame(matematicas=c(30,40,50, 55, 60,65,70, 75))
newdata1$rankP &lt;- predict(modelo1, newdata = newdata1, type = &quot;response&quot;)
newdata1</code></pre>
<pre><code>  matematicas       rankP
1          30 0.006037368
2          40 0.028186305
3          50 0.121647088
4          55 0.232326188
5          60 0.398068206
6          65 0.591019371
7          70 0.759489505
8          75 0.873424703</code></pre>
<p></br></br></p>
</div>
<div id="resumen" class="section level2">
<h2><span style="color:#034a94"><strong>Resumen</strong></spam></h2>
<p></br></p>
<div id="modelo-estimado" class="section level3">
<h3><strong>Modelo estimado</strong></h3>
<p><span class="math display">\[
logit(\text{matricula}) =  -9.793942 + 0.1563404 \hspace{.3cm}
\text{matematica}
\]</span></p>
</div>
<div id="probabilidad" class="section level3">
<h3><strong>Probabilidad</strong></h3>
<p><span class="math display">\[
P(\text{matricula}) =  \dfrac{\exp\{ -9.793942 + 0.1563404 \hspace{.3cm}
\text{matematica}\}}{1-\exp\{ -9.793942 + 0.1563404 \hspace{.3cm}
\text{matematica}\}}
\]</span></p>
<p></br></br></p>
</div>
</div>
<div id="capacidad-de-clasificación-del-modelo" class="section level2">
<h2><span style="color:#034a94"><strong>Capacidad de clasificación del
modelo</strong></span></h2>
<p>En una de las caracteristicas más importantes del modelo, pues
permite valorar a traves de la matriz de confución las clasificaciones
correctas por medio de las predicciones del modelo.</p>
<p>Existen adicionamente otros indicadores que pueden ser utilizados
como es el estadistico c asociado a la curva ROC (Trvrivrt Oprtsyong
Charasteristic) . Esta curva compara diferentes puntos de corte de la
probabilidad que permite establecer la tasa de clasificaciones correcta
de verdaderos positivos y de falsos positivos:</p>
<p><span class="math display">\[
TPR = \dfrac{\text{número de positivos correctamente
pronosticados}}{número de positivos reales totales}
\]</span></p>
<p><span class="math display">\[
FPR = \dfrac{\text{número de falsos positivos}}{\text{número de
negativos reales totales}}
\]</span></p>
<p>Es importante examinar la significancia de los coeficientes estimados
obtenidos mediante el metodode máxima verosimilitud. En este caso en
lugar de calcular el valor p para cada coeficiente, se utiliza el
estadistico <strong>Z</strong> y <strong>chi-cuadrado de
Wald</strong></p>
<p>Finalmente para convertir el valor estimado de probabilidad en una
categoría se debe encontrar el valor de un punto de corte a partir del
cual se considera que la variable <span class="math inline">\(Y\)</span>
pertenece a una categoría. En caso de que este valor fuese p=0.5 (<span
class="math inline">\(P(Y=1|X) &gt; 0.50\)</span>), entonce si la
estimación del modelo arroja un valor en el rango (0.50 - 1.0), se le
asignará el valor de <span class="math inline">\(1\)</span>, en caso
contrario tomará el valor de <span class="math inline">\(0\)</span>.</p>
<!-- ## **Modelo de regresión ligit múltiple** -->
<!-- En este caso se cuenta con más de una variable independiente, presentando la siguiente forma: -->
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
